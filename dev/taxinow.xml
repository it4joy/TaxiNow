<context>
	<input pattern="$Number">
		<var name="userPhoneNum" value="$Number" scope="user"/>
		<output value="Hi, I'm a taxi operator. Please, write your phone number, only digits."/>

		<context if="full($Number)">
			<input pattern="$Text">
				<context>
					<output value="Where are you?"/>
					<var name="StartPoint" value="$Text" scope="context"/>
					<output value="Ok. And where would you like to go?" if="full($Text)"/>
				</context>

				<context>
					<input pattern="$Text">
						<var name="endPoint" value="$Text" scope="context"/>
						<output value="Ok. What type of taxi you need?" if="full($Text)"/>

						<var name="finMsg" value="Thanks, I will send you a message with info about auto."/>

						<context>
							<sample>
								<item value="passenger"/>
								<item value="cargo"/>
							</sample>
							<pattern name="taxiType" value="(passenger|cargo)"/>
							<input pattern="$taxiType">
								<context if="full($taxiType) and $taxiType == 'passenger'">
									<var name="taxiType" value="$taxiType" scope="context"/>
									<output value="Will children with you?"/>
									<sample>
										<item value="yes"/>
										<item value="no"/>
									</sample>
									<pattern name="childrenAre" value="(yes|no)"/>
									<input pattern="$childrenAre">
										<context if="$childrenAre == 'yes'">
											<var name="children" value="$childrenAre" scope="context"/>
											<output value="How many and what is their age?"/>

											<input pattern="$Text">
												<context>
													<var name="childrenData" value="$Text" scope="context"/>
													<output value="$finMsg"/>
												</context>
											</input>
										</context>

										<context if="$childrenAre == 'no'">
											<output value="$finMsg"/>
										</context>
									</input>
								</context>

								<context if="full($taxiType) and $taxiType == 'cargo'">
									<output value="What type of truck you need?"/>
									<sample>
										<item value="< 1 tonne"/>
										<item value="< 2 tonne"/>
										<item value="< 3.5 tonne"/>
										<item value="< 5 tonne"/>
									</sample>
									<pattern name="tonnageSel" value="(< 1 tonne|< 2 tonne|< 3.5 tonne|< 5 tonne)"/>
									<input pattern="$tonnageSel">
										<context>
											<var name="tonnage" value="$tonnageSel" scope="context"/>
											<output value="$finMsg"/>
										</context>
									</input>
								</context>
							</input>
						</context>
						
						<context if="empty($epTxt)">
							<output value="Where would you like to go?"/>
						</context>
					</input>
				</context>

				<context if="empty($spTxt)">
					<output value="Please, write me where are you."/>
				</context>
			</input>
		</context>
	</input>
</context>