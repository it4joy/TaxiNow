<context>
	<input pattern="$Number">
		<var name="userPhoneNum" value="$Number" scope="user"/>
		<output value="Hi, I'm a taxi operator. Please, write your phone number, only digits."/>

		<context>
			<output value="Where are you?"/>
			<input pattern="$spTxt">
				<var name="StartPoint" value="$spTxt" scope="context"/>
				<output value="Ok. And where would you like to go?" if="full($spTxt)"/>
				<input pattern="$epTxt">
					<context>
						<var name="endPoint" value="$epTxt" scope="context"/>
						<ouput value="Ok. What type of taxi you need?" if="full($epTxt)"/>

						<var name="finMsg" value="Thanks, I will send you a message with info about auto."/>

						<sample>
							<item value="passenger"/>
							<item value="cargo"/>
						</sample>
						<input pattern="* $taxiType *">
							<context if="full($taxiType) and $taxiType == 'passenger'">
								<var name="taxiType" value="$taxiType" scope="context"/>
								<output value="Will children with you?"/>
								<sample>
									<item value="yes"/>
									<item value="no"/>
								</sample>
								<input pattern="$childrenAre">
									<context if="$childrenAre == 'yes'">
										<var name="children" value="$childrenAre" scope="context"/>
										<output value="How many and what is their age?"/>

										<input pattern="$chldProp">
											<context>
												<var name="childrenData" value="$chldProp" scope="context"/>
												<output value="$finMsg"/>
											</context>
										</input>
									</context>

									<context if="$childrenAre == 'no'">
										<output value="$finMsg"/>
									</context>
								</input>
							</context>

							<context if="full($taxiType) and $taxiType == 'cargo'">
								<output value="What type of truck you need?"/>
								<sample>
									<item value="before 1 tonne"/>
									<item value="before 2 tonne"/>
									<item value="before 3.5 tonne"/>
									<item value="before 5 tonne"/>
								</sample>
								<input pattern="$tonnageSel">
									<context>
										<var name="tonnage" value="$tonnageSel" scope="context"/>
										<output value="$finMsg"/>
									</context>
								</input>
							</context>
						</input>
					</context>
					
					<context if="empty($epTxt)">
						<output value="Where would you like to go?"/>
					</context>
				</input>

				<context if="empty($spTxt)">
					<output value="Please, write me where are you."/>
				</context>
			</input>
		</context>
	</input>
</context>